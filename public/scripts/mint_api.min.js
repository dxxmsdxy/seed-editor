window.bis||(window.bis={}),bis.keys=window.crypto_utils.keys,bis.Buff=window.buff_utils.Buff,bis.Address=window.tapscript.Address,bis.Signer=window.tapscript.Signer,bis.Tap=window.tapscript.Tap,bis.Tx=window.tapscript.Tx,bis.Script=window.tapscript.Script,bis.selected_network="mainnet",bis.wallet_type="",bis.api_initialised=!1,bis.__checkModulesInitialized=function(){const e=setInterval((()=>{console.log("checking modules"),window.bitcoin&&window.secp256k1&&(bitcoin.initEccLib(secp256k1),bis.api_initialised=!0,console.log("modules initialized"),clearInterval(e))}),250)},bis.__checkModulesInitialized(),bis.xverse_createSigningInput=function(e,t){const n=[],i=btoa(JSON.stringify(t));n.push(i);const s=btoa(JSON.stringify(e));n.push(s);return n.join(".")},bis.xverse_createUnsecuredToken=function(e){return bis.xverse_createSigningInput(e,{typ:"JWT",alg:"none"})+"."},bis.getWalletType=function(){return void 0!==window.unisat?(bis.wallet_type="unisat","unisat"):void 0!==window.BitcoinProvider?(bis.wallet_type="xverse","xverse"):(bis.wallet_type="unknown","unknown")},bis.requestAccounts=async function(e){if(""==bis.wallet_type&&bis.getWalletType(),"unisat"==bis.wallet_type){let e=await window.unisat.getNetwork();"livenet"==e&&"mainnet"!=bis.selected_network?await window.unisat.switchNetwork("testnet"):"testnet"==e&&"mainnet"==bis.selected_network&&await window.unisat.switchNetwork("livenet");let t=await window.unisat.requestAccounts(),n=[];for(const e of t)n.push({address:e,pubkey:null,purpose:"all"});return n}if("xverse"==bis.wallet_type){const t="mainnet"==bis.selected_network?"Mainnet":"Testnet",n=bis.xverse_createUnsecuredToken({purposes:["ordinals","payment"],message:e||"Address for receiving Ordinals and payments",network:{type:t}}),i=await window.BitcoinProvider.connect(n);let s=[];for(const e of i.addresses)s.push({address:e.address,pubkey:e.publicKey,purpose:e.purpose});return s}},bis.signMessageBIP322=async function(e,t){if(""==bis.wallet_type&&bis.getWalletType(),"unisat"==bis.wallet_type){let n=await window.unisat.getNetwork();if("livenet"==n&&"mainnet"!=bis.selected_network?await window.unisat.switchNetwork("testnet"):"testnet"==n&&"mainnet"==bis.selected_network&&await window.unisat.switchNetwork("livenet"),t&&t!=await getAccount())throw"Address mismatch";return await window.unisat.signMessage(e,"bip322-simple")}if("xverse"==bis.wallet_type){const n=bis.xverse_createUnsecuredToken({address:t,message:e});return await window.BitcoinProvider.signMessage(n)}},bis.checkBIP322Message=async function(e,t,n){const i=btoa(e);let s="https://ordapi.bestinslot.xyz/v1/verify/"+encodeURIComponent(t)+"/"+encodeURIComponent(n)+"/"+encodeURIComponent(i),o=await fetch(s);return await o.json()},bis.base64ToHex=function(e){const t=atob(e);let n="";for(let e=0;e<t.length;e++){const i=t.charCodeAt(e).toString(16);n+=2===i.length?i:"0"+i}return n.toLowerCase()},bis.signPSBT=async function(e,t,n,i){if(""==bis.wallet_type&&bis.getWalletType(),"unisat"==bis.wallet_type){let n=await window.unisat.getNetwork();"livenet"==n&&"mainnet"!=bis.selected_network?await window.unisat.switchNetwork("testnet"):"testnet"==n&&"mainnet"==bis.selected_network&&await window.unisat.switchNetwork("livenet");let i=bis.base64ToHex(e),s=await window.unisat.signPsbt(i);return t&&(s=await window.unisat.pushPsbt(s)),s}if("xverse"==bis.wallet_type){const s="mainnet"==bis.selected_network?"Mainnet":"Testnet",o=bis.xverse_createUnsecuredToken({network:{type:s},message:i||"Sign Transaction",psbtBase64:e,broadcast:t,inputsToSign:n});return await window.BitcoinProvider.signTransaction(o)}},bis.get_noinscr_utxos=async function(e){let t="https://seeds.mintapi.bestinslot.xyz/"+("mainnet"==bis.selected_network?"":"testnet/")+`utxo/${e}`,n=await fetch(t),i=await n.json(),s=[];for(const e of i.unmarked)s.push({utxo:e.utxo,value:e.value});return s},bis.txHexByIdCache={},bis.get_txhex=async function(e){if(!bis.txHexByIdCache[e]){let t="https://seeds.mintapi.bestinslot.xyz/"+("mainnet"==bis.selected_network?"":"testnet/")+`gettxhex/${e}`;bis.txHexByIdCache[e]=await fetch(t).then((e=>e.json()))}return bis.txHexByIdCache[e]},bis.ENABLE_RBF_NO_LOCKTIME=4294967293,bis.HEADERS_VBYTES=23,bis.ADDITIONAL_INPUT_P2TR_VBYTES=68,bis.ADDITIONAL_OUTPUT_P2TR_VBYTES=31,bis.ADDITIONAL_INPUT_P2SH_VBYTES=91,bis.ADDITIONAL_OUTPUT_P2SH_VBYTES=32,bis.estimate_fee=function(e,t,n,i,s){let o=bis.HEADERS_VBYTES;return o+=e*bis.ADDITIONAL_INPUT_P2TR_VBYTES,o+=t*bis.ADDITIONAL_OUTPUT_P2TR_VBYTES,o+=n*bis.ADDITIONAL_INPUT_P2SH_VBYTES,o+=i*bis.ADDITIONAL_OUTPUT_P2SH_VBYTES,o=Math.ceil(o),o*s},bis.DUST_VALUE=546,bis.build_transaction=function(e,t,n,i,s,o){let a=null!=t;e.sort(((e,t)=>e.value-t.value));let l=[],c=[{out_script:n,value:0}],r=bis.estimate_fee(a?0:l.length,a?1:c.length,a?l.length:0,a?c.length-1:0,s);for(;c[0].value<o+r;){let t=o+r-c[0].value;const n=Math.ceil(a?bis.ADDITIONAL_INPUT_P2SH_VBYTES:bis.ADDITIONAL_INPUT_P2TR_VBYTES)*s;for(;t>0;){if(0==e.length)throw new Error("Not enough funds");let i=t+n;if(e[e.length-1].value>=i){for(const n of e)if(n.value>=i){l.push(n),c[0].value+=n.value,t=0,e.splice(e.indexOf(n),1);break}}else{t-=e[e.length-1].value-n,l.push(e.pop()),c[0].value+=l[l.length-1].value}}}const _=Math.ceil(a?bis.ADDITIONAL_OUTPUT_P2SH_VBYTES:bis.ADDITIONAL_OUTPUT_P2TR_VBYTES);r=bis.estimate_fee(a?0:l.length,a?1:c.length,a?l.length:0,a?c.length-1:0,s);let d=c[0].value;if(d-r>o&&d-o>bis.DUST_VALUE+r+_*s){let e=d-o;c[0].value=o,c.push({out_script:i,value:e})}if(r=bis.estimate_fee(a?0:l.length,a?1:c.length,a?l.length:0,a?c.length-1:0,s),c[c.length-1].value-r<bis.DUST_VALUE)throw new Error("Last output cannot pay the fee");c[c.length-1].value-=r;const u="mainnet"==bis.selected_network?bitcoin.networks.bitcoin:bitcoin.networks.testnet;let b=new bitcoin.Transaction(u);for(let e=0;e<l.length;e++)null==t?b.ins.push({hash:__Buffer.from(l[e].utxo.split(":")[0],"hex"),index:parseInt(l[e].utxo.split(":")[1]),script:__Buffer.from("","hex"),sequence:bis.ENABLE_RBF_NO_LOCKTIME,witness:[]}):b.ins.push({hash:__Buffer.from(l[e].utxo.split(":")[0],"hex"),index:parseInt(l[e].utxo.split(":")[1]),script:t,sequence:bis.ENABLE_RBF_NO_LOCKTIME,witness:[]});for(let e=0;e<c.length;e++)b.addOutput(c[e].out_script,c[e].value);let p=0;for(const e of l)p+=e.value;for(const e of c)p-=e.value;return{tx:b,commit_fee:p}},bis.build_commit_tx_xverse=async function(e,t,n,i,s,o,a,l,c,r){r<0&&(r=0);const _=e;let d=await bis.get_noinscr_utxos(e);console.log(d);const u=bis.keys.get_seckey(i),b=bis.keys.get_pubkey(u,!0);console.log(u),console.log(b);const p=[b,"OP_CHECKSIG","OP_0","OP_IF",bis.Buff.str("ord"),"01",bis.Buff.str(s),"OP_0"];for(let e=0;e<o.length;e+=520)p.push(o.subarray(e,e+520));p.push("OP_ENDIF");let m=__Buffer.from(bis.Script.encode(p,!1));console.log("myScript is ",m);const f=bis.Tap.encodeScript(p),[x,w]=bis.Tap.getPubKey(b,{target:f}),g="mainnet"==bis.selected_network?bitcoin.networks.bitcoin:bitcoin.networks.testnet,h=bitcoin.payments.p2tr({pubkey:__Buffer.from(x,"hex"),network:g});console.log("Commit tx address: ",h.address);let v=null;if(t)try{let e=__Buffer.from(t,"hex"),n=bitcoin.payments.p2wpkh({pubkey:e,network:g});v=bitcoin.payments.p2sh({redeem:n,network:g}).redeem.output}catch(e){console.log(e)}console.log("redeemScript",v,t);const y=[{value:0,scriptPubKey:bis.Address.toScriptPubKey(n)}];r>0&&y.push({value:0,scriptPubKey:bis.Address.toScriptPubKey(c)});const S=bis.Tx.create({vin:[{txid:"0000000000000000000000000000000000000000000000000000000000000000",vout:0,prevout:{value:0,scriptPubKey:["OP_1",x]}}],vout:y});S.vin[0].witness=[bis.Buff.hex("00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),p,w];let I=bis.Tx.util.getTxSize(S).vsize*a;console.log("reveal_fee:",I);let B=__Buffer.from(bis.Script.encode(bis.Address.toScriptPubKey(_),!1)),T=__Buffer.from(bis.Script.encode(bis.Address.toScriptPubKey(h.address),!1)),k=bis.build_transaction(d,v,T,B,a,l+I+r),W=k.tx,P=k.commit_fee;const C=new bitcoin.Psbt({network:g});for(const e of W.ins){let n=await bis.get_txhex(e.hash.toString("hex")),i=bitcoin.Transaction.fromHex(n);for(const e in i.outs)try{i.setWitness(parseInt(e),[])}catch{}v?C.addInput({hash:e.hash.toString("hex"),index:e.index,witnessUtxo:i.outs[e.index],redeemScript:v}):t?C.addInput({hash:e.hash.toString("hex"),index:e.index,witnessUtxo:i.outs[e.index],sighashType:bitcoin.Transaction.SIGHASH_DEFAULT,tapInternalKey:__Buffer.from(t,"hex")}):C.addInput({hash:e.hash.toString("hex"),index:e.index,witnessUtxo:i.outs[e.index]})}for(const e of W.outs)C.addOutput(e);return console.log("Unsigned commit psbt hex:",C.toHex()),console.log("Commit output value: ",W.outs[0].value),{unsigned_psbt_hex:C.toHex(),output_value:W.outs[0].value,commit_fee:P,reveal_fee:I}},bis.build_reveal_tx_xverse=async function(e,t,n,i,s,o,a,l,c,r){r<0&&(r=0);const _=bis.keys.get_seckey(i),d=bis.keys.get_pubkey(_,!0),u=[d,"OP_CHECKSIG","OP_0","OP_IF",bis.Buff.encode("ord"),"01",bis.Buff.encode(s),"OP_0"];for(let e=0;e<o.length;e+=520)u.push(o.subarray(e,e+520));u.push("OP_ENDIF");let b=__Buffer.from(bis.Script.encode(u,!1));console.log("myScript is ",b);const p=bis.Tap.encodeScript(u),[m,f]=bis.Tap.getPubKey(d,{target:p}),x="mainnet"==bis.selected_network?bitcoin.networks.bitcoin:bitcoin.networks.testnet,w=bitcoin.payments.p2tr({pubkey:__Buffer.from(m,"hex"),network:x});console.log("Commit tx address: ",w.address);let g=[{txid:t,vout:0}];const h=[{value:l,scriptPubKey:bis.Address.toScriptPubKey(e)}];r>0&&h.push({value:r,scriptPubKey:bis.Address.toScriptPubKey(c)});const v=bis.Tx.create({vin:[{txid:g[0].txid,vout:g[0].vout,prevout:{value:n,scriptPubKey:["OP_1",m]}}],vout:h}),y=bis.Signer.taproot.sign(_,v,0,{extension:p});v.vin[0].witness=[y,u,f];bis.Signer.taproot.verify(v,0,{pubkey:d,throws:!0});return{txid:bis.Tx.util.getTxid(v),signed_reveal_tx_hex:bis.Tx.encode(v).hex}},bis.build_commit_tx_unisat=async function(e,t,n,i,s,o,a,l){l<0&&(l=0);const c=null,r=e,_=e;let d=await bis.get_noinscr_utxos(e);console.log(d);const u=bis.keys.get_seckey(t),b=bis.keys.get_pubkey(u,!0);console.log(u),console.log(b);const p=[b,"OP_CHECKSIG","OP_0","OP_IF",bis.Buff.encode("ord"),"01",bis.Buff.encode(n),"OP_0"];for(let e=0;e<i.length;e+=520)p.push(i.subarray(e,e+520));p.push("OP_ENDIF");let m=__Buffer.from(bis.Script.encode(p,!1));console.log("myScript is ",m);const f=bis.Tap.encodeScript(p),[x,w]=bis.Tap.getPubKey(b,{target:f}),g="mainnet"==bis.selected_network?bitcoin.networks.bitcoin:bitcoin.networks.testnet,h=bitcoin.payments.p2tr({pubkey:__Buffer.from(x,"hex"),network:g});console.log("Commit tx address: ",h.address);const v=[{value:0,scriptPubKey:bis.Address.toScriptPubKey(_)}];l>0&&v.push({value:0,scriptPubKey:bis.Address.toScriptPubKey(a)});const y=bis.Tx.create({vin:[{txid:"0000000000000000000000000000000000000000000000000000000000000000",vout:0,prevout:{value:0,scriptPubKey:["OP_1",x]}}],vout:v});y.vin[0].witness=[bis.Buff.hex("00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),p,w];let S=bis.Tx.util.getTxSize(y).vsize*s;console.log("reveal_fee:",S);let I=bitcoin.address.toOutputScript(r,g),B=bitcoin.address.toOutputScript(h.address,g),T=null;console.log("redeemScript",T,c);let k=bis.build_transaction(d,T,B,I,s,o+S+l),W=k.tx,P=k.commit_fee;const C=new bitcoin.Psbt({network:g});for(const e of W.ins){let t=await bis.get_txhex(e.hash.toString("hex")),n=bitcoin.Transaction.fromHex(t);for(const e in n.outs)try{n.setWitness(parseInt(e),[])}catch{}T?C.addInput({hash:e.hash.toString("hex"),index:e.index,witnessUtxo:n.outs[e.index],redeemScript:T}):C.addInput({hash:e.hash.toString("hex"),index:e.index,witnessUtxo:n.outs[e.index]})}for(const e of W.outs)C.addOutput(e);return{unsigned_psbt_hex:C.toHex(),output_value:W.outs[0].value,commit_fee:P,reveal_fee:S}},bis.build_reveal_tx_unisat=async function(e,t,n,i,s,o,a,l,c,r){r<0&&(r=0);const _=bis.keys.get_seckey(i),d=bis.keys.get_pubkey(_,!0),u=[d,"OP_CHECKSIG","OP_0","OP_IF",bis.Buff.encode("ord"),"01",bis.Buff.encode(s),"OP_0"];for(let e=0;e<o.length;e+=520)u.push(o.subarray(e,e+520));u.push("OP_ENDIF");let b=__Buffer.from(bis.Script.encode(u,!1));console.log("myScript is ",b);const p=bis.Tap.encodeScript(u),[m,f]=bis.Tap.getPubKey(d,{target:p}),x="mainnet"==bis.selected_network?bitcoin.networks.bitcoin:bitcoin.networks.testnet,w=bitcoin.payments.p2tr({pubkey:__Buffer.from(m,"hex"),network:x});console.log("Commit tx address: ",w.address);let g=[{txid:t,vout:0}];const h=[{value:l,scriptPubKey:bis.Address.toScriptPubKey(e)}];r>0&&h.push({value:r,scriptPubKey:bis.Address.toScriptPubKey(c)});const v=bis.Tx.create({vin:[{txid:g[0].txid,vout:g[0].vout,prevout:{value:n,scriptPubKey:["OP_1",m]}}],vout:h}),y=bis.Signer.taproot.sign(_,v,0,{extension:p});v.vin[0].witness=[y,u,f];bis.Signer.taproot.verify(v,0,{pubkey:d,throws:!0});return{txid:bis.Tx.util.getTxid(v),signed_reveal_tx_hex:bis.Tx.encode(v).hex}},bis.hexToBase64=function(e){return btoa(e.match(/\w{2}/g).map((function(e){return String.fromCharCode(parseInt(e,16))})).join(""))},bis.sign_via_xverse=async function(e,t){let n=bitcoin.Psbt.fromHex(e),i=[];for(let e=0;e<n.inputCount;e++)i.push(e);bis.wallet_type="xverse";let s=await bis.signPSBT(bis.hexToBase64(e),!1,[{address:t,signingIndexes:i,sigHash:bitcoin.Transaction.SIGHASH_DEFAULT}],"sign this pls"),o=bitcoin.Psbt.fromBase64(s.psbtBase64);try{o.finalizeAllInputs()}catch{}let a=o.extractTransaction(),l=a.toHex();return{txid:a.getId(),signed_tx_hex:l}},bis.sign_via_unisat=async function(e,t){bis.wallet_type="unisat";let n=await bis.signPSBT(bis.hexToBase64(e),!1,[],"sign this pls"),i=bitcoin.Psbt.fromHex(n);try{i.finalizeAllInputs()}catch{}let s=i.extractTransaction(),o=s.toHex();return{txid:s.getId(),signed_tx_hex:o}},bis.check_txes=async function(e,t){try{const n="mainnet"==bis.selected_network?"":"https://seeds.mintapi.bestinslot.xyz/testnet/testmempoolaccept",i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({txhexes:[e,t]})});return await i.json()}catch{return null}},bis.broadcast_txes=async function(e){try{const t="mainnet"==bis.selected_network?"":"https://seeds.mintapi.bestinslot.xyz/testnet/sendrawtransactions",n=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({txhexes:e})});return await n.json()}catch{return null}},bis.broadcast_txes_collection=async function(e,t){try{const n="mainnet"==bis.selected_network?"":"https://seeds.mintapi.bestinslot.xyz/testnet/collection/sendrawtransactions",i=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({txhexes:e,collection_slug:t})});return await i.json()}catch{return null}},bis.sleep=e=>new Promise((t=>setTimeout(t,e,"done sleeping"))),bis.mint_xverse=async function(e,t,n,i,s,o,a,l,c){bis.wallet_type="xverse";let r="",_="",d="";for(const t of e)"payment"==t.purpose?(r=t.address,_=t.pubkey):"ordinals"==t.purpose&&(d=t.address);const u="0a7d01d1c2e1592a02ea7671bb79ecd31d8d5e660b008f4b10e67787f4f24712",b=await bis.build_commit_tx_xverse(r,_,d,u,t,n,i,s,o,a),p=await bis.sign_via_xverse(b.unsigned_psbt_hex,r),m=bitcoin.Transaction.fromHex(p.signed_tx_hex).virtualSize();console.log("virtualSize1:",m);const f=p.txid,x=await bis.build_reveal_tx_xverse(d,f,b.output_value,u,t,n,i,s,o,a);console.log(p.signed_tx_hex),console.log(x.signed_reveal_tx_hex);const w=await bis.check_txes(p.signed_tx_hex,x.signed_reveal_tx_hex);console.log(w);for(const e of w)if(console.log("tx is allowed: ",e.allowed),!e.allowed)throw new Error(e["reject-reason"]);if(l)return{commit_txid:p.txid,signed_commit_tx_hex:p.signed_tx_hex,reveal_txid:x.txid,signed_reveal_tx_hex:x.signed_reveal_tx_hex,inscription_id:x.txid+"i0"};if(null==c){let e=await bis.broadcast_txes([p.signed_tx_hex,x.signed_reveal_tx_hex]);return console.log(e),{commit_txid:p.txid,signed_commit_tx_hex:p.signed_tx_hex,reveal_txid:x.txid,signed_reveal_tx_hex:x.signed_reveal_tx_hex,inscription_id:x.txid+"i0"}}{let e=await bis.broadcast_txes_collection([p.signed_tx_hex,x.signed_reveal_tx_hex],c);return console.log(e),{commit_txid:p.txid,signed_commit_tx_hex:p.signed_tx_hex,reveal_txid:x.txid,signed_reveal_tx_hex:x.signed_reveal_tx_hex,inscription_id:x.txid+"i0"}}},bis.mint_unisat=async function(e,t,n,i,s,o,a,l,c){bis.wallet_type="unisat";let r=e[0].address;const _="0a7d01d1c2e1592a02ea7671bb79ecd31d8d5e660b008f4b10e67787f4f24712",d=await bis.build_commit_tx_unisat(r,_,t,n,i,s,o,a),u=await bis.sign_via_unisat(d.unsigned_psbt_hex,r),b=bitcoin.Transaction.fromHex(u.signed_tx_hex).virtualSize();console.log("virtualSize1:",b);const p=u.txid,m=await bis.build_reveal_tx_unisat(r,p,d.output_value,_,t,n,i,s,o,a);console.log(u.signed_tx_hex),console.log(m.signed_reveal_tx_hex);const f=await bis.check_txes(u.signed_tx_hex,m.signed_reveal_tx_hex);console.log(f);for(const e of f)if(console.log("tx is allowed: ",e.allowed),!e.allowed)throw new Error(e["reject-reason"]);if(l)return{commit_txid:u.txid,signed_commit_tx_hex:u.signed_tx_hex,reveal_txid:m.txid,signed_reveal_tx_hex:m.signed_reveal_tx_hex,inscription_id:m.txid+"i0"};if(null==c){let e=await bis.broadcast_txes([u.signed_tx_hex,m.signed_reveal_tx_hex]);return console.log(e),{commit_txid:u.txid,signed_commit_tx_hex:u.signed_tx_hex,reveal_txid:m.txid,signed_reveal_tx_hex:m.signed_reveal_tx_hex,inscription_id:m.txid+"i0"}}{let e=await bis.broadcast_txes_collection([u.signed_tx_hex,m.signed_reveal_tx_hex],c);return console.log(e),{commit_txid:u.txid,signed_commit_tx_hex:u.signed_tx_hex,reveal_txid:m.txid,signed_reveal_tx_hex:m.signed_reveal_tx_hex,inscription_id:m.txid+"i0"}}},bis.check_mint_fee_xverse=async function(e,t,n,i,s,o,a){let l="",c="",r="";for(const t of e)"payment"==t.purpose?(l=t.address,c=t.pubkey):"ordinals"==t.purpose&&(r=t.address);const _=await bis.build_commit_tx_xverse(l,c,r,"0a7d01d1c2e1592a02ea7671bb79ecd31d8d5e660b008f4b10e67787f4f24712",t,n,i,s,o,a);return{total_fee:_.commit_fee+_.reveal_fee,commit_fee:_.commit_fee,reveal_fee:_.reveal_fee}},bis.check_mint_fee_unisat=async function(e,t,n,i,s,o,a){let l=e[0].address;const c=await bis.build_commit_tx_unisat(l,"0a7d01d1c2e1592a02ea7671bb79ecd31d8d5e660b008f4b10e67787f4f24712",t,n,i,s,o,a);return{total_fee:c.commit_fee+c.reveal_fee,commit_fee:c.commit_fee,reveal_fee:c.reveal_fee}},bis.mint=async function(e,t,n,i,s,o,a,l){if("string"!=typeof t)throw new Error("mime_type must be a string");if(!(n instanceof bis.Buff))throw new Error("file_data must be of type bis.Buff");if("number"!=typeof i||!Number.isInteger(i))throw new Error("fee_rate must be an integer");if("number"!=typeof s||!Number.isInteger(s))throw new Error("postage must be an integer");if("string"!=typeof o)throw new Error("payee_addr must be a string");if("number"!=typeof a||!Number.isInteger(a))throw new Error("payment must be an integer");if("boolean"!=typeof l)throw new Error("dry_run must be a boolean");if("unisat"!=e.wallet&&"xverse"!=e.wallet)throw new Error("connected_wallet struct is faulty");return"unisat"==e.wallet?(bis.wallet_type="unisat",await bis.mint_unisat(e.info,t,n,i,s,o,a,l,null)):"xverse"==e.wallet?(bis.wallet_type="xverse",await bis.mint_xverse(e.info,t,n,i,s,o,a,l,null)):null},bis.check_mint_fee=async function(e,t,n,i,s,o,a){if("string"!=typeof t)throw new Error("mime_type must be a string");if(!(n instanceof bis.Buff))throw new Error("file_data must be of type bis.Buff");if("number"!=typeof i||!Number.isInteger(i))throw new Error("fee_rate must be an integer");if("number"!=typeof s||!Number.isInteger(s))throw new Error("postage must be an integer");if("string"!=typeof o)throw new Error("payee_addr must be a string");if("number"!=typeof a||!Number.isInteger(a))throw new Error("payment must be an integer");if("unisat"!=e.wallet&&"xverse"!=e.wallet)throw new Error("connected_wallet struct is faulty");return"unisat"==e.wallet?(bis.wallet_type="unisat",await bis.check_mint_fee_unisat(e.info,t,n,i,s,o,a)):"xverse"==e.wallet?(bis.wallet_type="xverse",await bis.check_mint_fee_xverse(e.info,t,n,i,s,o,a)):null},bis.retrieveCachedWallet=function(){let e=localStorage.getItem("BIS_cachedWallet");return null==e?null:JSON.parse(e)},bis.clearCachedWallet=function(){localStorage.removeItem("BIS_cachedWallet")},bis.showConnectWalletModal=function(e,t){return document.getElementById("BIS_connectWalletBackground")||bis.initialize_modal(),new Promise(((n,i)=>{async function s(){document.getElementById("BIS_connectWalletConfirmConnectionDiv").classList.remove("BIS_Failed");try{let e=await bis.requestAccounts();document.getElementById("BIS_connectWalletBackground").className="",document.getElementById("BIS_connectWalletContentDiv").className="",console.log(e),n({wallets:e,signature:null})}catch{document.getElementById("BIS_connectWalletConfirmConnectionDiv").classList.add("BIS_Failed")}}t?i("not implemented yet"):(document.getElementById("BIS_connectWalletBackground").className="BIS_show",e||document.getElementById("BIS_connectWalletBackground").classList.add("BIS_Light"),document.getElementById("BIS_connectWalletContentDiv").className="BIS_state_select_wallet",document.getElementById("BIS_connectWalletHeaderClose").onclick=function(){document.getElementById("BIS_connectWalletBackground").className="",document.getElementById("BIS_connectWalletContentDiv").className="",i("closed")},document.getElementById("BIS_connectWalletSelectWalletUnisat").onclick=function(){bis.wallet_type="unisat",document.getElementById("BIS_connectWalletContentDiv").className="BIS_state_confirm_connection",document.getElementById("BIS_connectWalletConfirmConnectionDiv").className="BIS_Unisat",s()},document.getElementById("BIS_connectWalletSelectWalletXverse").onclick=function(){bis.wallet_type="xverse",document.getElementById("BIS_connectWalletContentDiv").className="BIS_state_confirm_connection",document.getElementById("BIS_connectWalletConfirmConnectionDiv").className="BIS_Xverse",s()},document.getElementById("BIS_connectWalletConfirmConnectionFailedBackButton").onclick=function(){document.getElementById("BIS_connectWalletContentDiv").className="BIS_state_select_wallet"},document.getElementById("BIS_connectWalletConfirmConnectionFailedRetryButton").onclick=function(){s()})}))},bis.is_connecting=!1,bis.connectWallet=async function(e,t){if(document.getElementById("BIS_connectWalletBackground")||bis.initialize_modal(),t)throw new Error("not implemented yet");if(bis.is_connecting)throw new Error("already open");bis.is_connecting=!0;try{let n=await bis.showConnectWalletModal(e,t),i={info:n.wallets,wallet:bis.wallet_type,signature:n.signature};return localStorage.setItem("BIS_cachedWallet",JSON.stringify(i)),i}catch(e){throw e}finally{bis.is_connecting=!1}},bis.modal_html='\n<div id="BIS_connectWalletBackground">\n  <div id="BIS_connectWalletDiv">\n    <div id="BIS_connectWalletHeaderDiv">\n      <span id="BIS_connectWalletHeaderText">Connect&nbsp;Wallet</span>\n      <img id="BIS_connectWalletHeaderClose">\n    </div>\n    <div id="BIS_connectWalletContentDiv">\n      <div id="BIS_connectWalletSelectWalletDiv">\n        <p class="BIS_connectWalletContentHeader">Select&nbsp;your&nbsp;Bitcoin&nbsp;wallet</p>\n        <div id="BIS_connectWalletSelectWalletWalletsDiv">\n          <div id="BIS_connectWalletSelectWalletUnisat" class="BIS_connectWalletSelectWalletSingleWalletDiv">\n            <div class="BIS_connectWalletSelectWalletSingleWalletNameIconDiv">\n              <img class="BIS_connectWalletSelectWalletSingleWalletIcon BIS_Unisat">\n              <span class="BIS_connectWalletSelectWalletSingleWalletName">UniSat</span>\n            </div>\n            <span class="BIS_connectWalletSelectWalletSingleWalletRightArrow">&gt;</span>\n          </div>\n\n          <div id="BIS_connectWalletSelectWalletXverse" class="BIS_connectWalletSelectWalletSingleWalletDiv">\n            <div class="BIS_connectWalletSelectWalletSingleWalletNameIconDiv">\n              <img class="BIS_connectWalletSelectWalletSingleWalletIcon BIS_Xverse">\n              <span class="BIS_connectWalletSelectWalletSingleWalletName">Xverse</span>\n            </div>\n            <span class="BIS_connectWalletSelectWalletSingleWalletRightArrow">&gt;</span>\n          </div>\n        </div>\n      </div>\n\n      <div id="BIS_connectWalletConfirmConnectionDiv">\n        <p class="BIS_connectWalletContentHeader">Confirm&nbsp;connection&nbsp;on</p>\n\n        <div id="BIS_connectWalletConfirmConnectionWalletDiv">\n          <img id="BIS_connectWalletConfirmConnectionSingleWalletIcon">\n          <span id="BIS_connectWalletConfirmConnectionSingleWalletName"></span>\n        </div>\n\n        <div class="BIS_connectWalletContentDivider"></div>\n\n        <span id="BIS_connectWalletConfirmConnectionWaitingText1" class="BIS_connectWalletContentNormalText BIS_connectWalletMT30">Check&nbsp;your&nbsp;extension&nbsp;and<br>confirm&nbsp;the&nbsp;connection...</span>\n        <img id="BIS_connectWalletConfirmConnectionWaitingImg1" class="BIS_connectWalletParrots BIS_connectWalletMT15">\n\n        <span id="BIS_connectWalletConfirmConnectionFailedText1" class="BIS_connectWalletContentNormalText BIS_connectWalletMT30">Connection&nbsp;Failed!</span>\n        <img id="BIS_connectWalletConfirmConnectionFailedImg1" class="BIS_connectWalletFailedIcon BIS_connectWalletMT15">\n\n        <div id="BIS_connectWalletConfirmConnectionFailedButtonsDiv">\n          <div id="BIS_connectWalletConfirmConnectionFailedBackButton" class="BIS_connectWalletSmallButton">\n            <span class="BIS_connectWalletSmallButtonText">&lt;&nbsp;Back</span>\n          </div>\n          <div id="BIS_connectWalletConfirmConnectionFailedRetryButton" class="BIS_connectWalletSmallButton">\n            <span class="BIS_connectWalletSmallButtonText">Retry&nbsp;&gt;</span>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div id="BIS_connectWalletFooterDiv">\n      <p id="BIS_connectWalletFooterTextLine1">Powered&nbsp;by&nbsp;<span class="BIS_connectWalletBold BIS_connectWalletWhite">[Best&nbsp;in&nbsp;Slot]</span></p>\n      <a id="BIS_connectWalletFooterTextLine2" href="https://bestinslot.xyz/api" target="_blank">Learn&nbsp;more&nbsp;about&nbsp;Connect&nbsp;API&nbsp;&gt;</a>\n    </div>\n  </div>\n</div>',bis.modal_initialized=!1,bis.initialize_modal=function(){let e=document.createElement("div");document.body.appendChild(e),e.outerHTML=bis.modal_html,bis.modal_initialized=!0},bis.setNetwork=function(e){if("mainnet"==e)bis.selected_network="mainnet";else{if("testnet"!=e)throw new Error("invalid network");bis.selected_network="testnet"}},bis.remaining_items_in_collection=async function(e){let t="https://seeds.mintapi.bestinslot.xyz/"+("mainnet"==bis.selected_network?"":"testnet/")+`remaining_items_in_collection/${e}`,n=await fetch(t);if(!n.ok)throw new Error("HTTP error "+n.status+": "+await n.text());return await n.json()},bis.get_inscription_name=async function(e){let t="https://seeds.mintapi.bestinslot.xyz/"+("mainnet"==bis.selected_network?"":"testnet/")+`get_inscription_name/${e}`,n=await fetch(t);if(!n.ok)throw new Error("HTTP error "+n.status+": "+await n.text());return(await n.json()).name},bis.collection_mint=async function(e,t,n){let i="https://seeds.mintapi.bestinslot.xyz/"+("mainnet"==bis.selected_network?"":"testnet/")+`get_mint_info/${t}`,s=await fetch(i);if(!s.ok)throw new Error("HTTP error "+s.status+": "+await s.text());let o=await s.json(),a=o.mime_type,l=o.file_data,c=o.postage,r=o.payee_addr,_=o.payment_amount;if("unisat"!=e.wallet&&"xverse"!=e.wallet)throw new Error("connected_wallet struct is faulty");return"unisat"==e.wallet?(bis.wallet_type="unisat",await bis.mint_unisat(e.info,a,bis.Buff.hex(l),n,c,r,_,!1,t)):"xverse"==e.wallet?(bis.wallet_type="xverse",await bis.mint_xverse(e.info,a,bis.Buff.hex(l),n,c,r,_,!1,t)):null},bis.check_collection_mint_fee=async function(e,t,n){let i="https://seeds.mintapi.bestinslot.xyz/"+("mainnet"==bis.selected_network?"":"testnet/")+`get_mint_info/${t}`,s=await fetch(i);if(!s.ok)throw new Error("HTTP error "+s.status+": "+await s.text());let o=await s.json(),a=o.mime_type,l=o.file_data,c=o.postage,r=o.payee_addr,_=o.payment_amount;return await bis.check_mint_fee(e,a,bis.Buff.hex(l),n,c,r,_)},window.bis.highLevel={connectWallet:bis.connectWallet,retrieveCachedWallet:bis.retrieveCachedWallet,clearCachedWallet:bis.clearCachedWallet,inscribe:bis.mint,checkInscribeFee:bis.check_mint_fee,setNetwork:bis.setNetwork,remainingItemsInCollection:bis.remaining_items_in_collection,getInscriptionName:bis.get_inscription_name,collectionInscribe:bis.collection_mint,checkCollectionInscribeFee:bis.check_collection_mint_fee};